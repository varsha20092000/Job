{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{% static 'css/jobs.css' %}">
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Jobs Page</title>
  <style>
    .hidden {
      display: none;
    }

    .recruiter-action-section {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      margin: auto;
      width: 80%;
      padding: 20px;
      background: white;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .job-card {
      transition: transform 0.3s ease-in-out;
    }

    .job-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
  </style>

</head>

<body>

  <!-- Header Section -->
<header class="bg-blue-600 text-white p-4 flex justify-between items-center fixed top-0 left-0 w-full z-50 shadow-md">
    <div class="text-2xl font-bold">
      <a href="{% url 'home' %}" class="text-white text-2xl font-bold hover:underline">JOB365</a>
    </div>

    <div class="flex items-center gap-6">
      <nav class="hidden md:flex space-x-6">
        <a href="{% url 'home' %}" class="hover:text-gray-300">Home</a>
        <a href="{% url 'jobs' %}" class="hover:text-gray-300">Jobs</a>
        <a href="{% url 'certificate' %}" class="hover:text-gray-300">Certificate</a>
        <a href="{% url 'income' %}" class="hover:text-gray-300">Income</a>
         <div class="relative">
        <a href="#" class="hover:text-gray-300" id="contactDropdown">Contact</a>
       <div class="absolute right-0 mt-2 bg-white shadow-md rounded-lg w-48 hidden z-50" id="contactMenu">

          <a href="{% url 'jobemail_support' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-gray-100">
            üìß Email Support
          </a>
          <a href="{% url 'jobcall_support' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-gray-100">
            üìû Call Support
          </a>
          
        </div>
      </div>
        <a href="{% url 'notifications' %}" class="hover:text-gray-300">Notifications</a>
      </nav>

      <div class="relative group">
        <button class="flex items-center text-white">
          <img src="https://www.w3schools.com/w3images/avatar2.png" alt="Profile Avatar"
            class="w-12 h-12 rounded-full mr-2">
          <span class="font-semibold">User</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>

        <div class="absolute right-0 mt-2 bg-white shadow-md rounded-lg w-48 hidden group-hover:block">
          <a href="{% url 'profile' %}" class="block px-4 py-2 text-gray-800 hover:bg-gray-100">Profile</a>

          <a href="#" class="block px-4 py-2 text-gray-800 hover:bg-gray-100">Logout</a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="pt-20">
    <div class="max-w-screen-xl mx-auto flex gap-6 px-6">

      <!-- Left Profile Panel -->
      <div class="left-panel w-2/32 p-4 bg-blue-100 rounded-lg">
        <div class="profile-box text-center">
          <img src="https://www.w3schools.com/w3images/avatar2.png" alt="Profile Avatar" class="avatar mx-auto mb-4">
          <h2 class="text-lg font-semibold">
            {% if user.is_authenticated %}
            {{ user.first_name }} {{ user.last_name }}
            {% else %}
            Guest
            {% endif %}
          </h2>
          <p>Calicut, Kerala</p> <!-- You can also make location dynamic if needed -->
          <hr class="my-3">
         <a href="{% url 'profile' %}" class="edit-profile-btn inline-block px-4 py-2 bg-blue-500 text-white rounded-md">
  ‚úèÔ∏è Edit Profile
</a>

        </div>
      </div>


      <!-- Middle Job Listings -->
      <div class="middle-panel w-4/5 p-6 bg-white rounded-lg shadow-lg">
        <div class="search-bar mb-6 flex gap-4">
  <input type="text" id="jobSearchInput" class="p-3 rounded-md border w-full" placeholder="Search jobs by title, company, skill">
  <button class="search-btn bg-blue-500 text-white px-6 py-3 rounded-md" onclick="searchJobs()">üîç Search</button>
  <button class="filter-btn bg-blue-500 text-white px-6 py-3 rounded-md" onclick="openFilterPopup()">‚öôÔ∏è Filter</button>
</div>

        <div class="filter-overlay" id="filterOverlay" onclick="closeFilterPopup()"></div>
        <div class="filter-popup" id="filterPopup">
          <div class="filter-heading">
            <span>Filter</span>
            <button class="close-btn" onclick="closeFilterPopup()">X</button>
          </div>
          <hr>
          <div class="filter-content">
            <div class="date-range">
              <div>
                <span>üìÖ From</span>
                <div>20-05-2025</div>
              </div>
              <div class="vertical-line"></div>
              <div>
                <span>üìÖ To</span>
                <div>20-05-2025</div>
              </div>
            </div>
            <button class="go-btn">Go</button>
          </div>
        </div>

<div class="nav-buttons mb-6 flex gap-4">
  <button class="nav-btn bg-blue-500 text-white px-6 py-3 rounded-md" data-target="your-work">Your Work</button>
  <button class="nav-btn bg-blue-500 text-white px-6 py-3 rounded-md" data-target="applied-jobs">Applied Jobs</button>
  <button class="nav-btn bg-blue-500 text-white px-6 py-3 rounded-md" data-target="saved-jobs">Saved Jobs</button>
  <button class="nav-btn bg-blue-500 text-white px-6 py-3 rounded-md" data-target="recruiter-action">Recruiter Action</button>
</div>


        <!-- Job Listings -->
        <div id="your-work" class="job-listings grid grid-cols-2 gap-6">
          <!-- Job Card Example -->
          <div class="job-card bg-white p-4 rounded-xl shadow-md border border-gray-300">
            <div class="flex items-center gap-3">
              <div class="job-icon text-4xl bg-pink-200 p-2 rounded-full">‚òÄÔ∏è</div>
              <div>
                <h3 class="font-bold text-lg">Junior Designer</h3>
                <p class="text-gray-600">Abcd Technologies Pvt Ltd.</p>
                <p class="text-gray-500 flex items-center gap-1">üìç Calicut, Kerala</p>
              </div>
            </div>
            <hr class="my-3 border-gray-400">
            <div class="text-sm text-gray-700 space-y-1">
              <p>Hourly Rate <span class="float-right">: 500/Hour</span></p>
              <p>Total Work Hours <span class="float-right">: 5 Hour</span></p>
              <p>Total Earnings <span class="float-right">: 2500 RS</span></p>
            </div>
          </div>

          <div class="job-card bg-white p-4 rounded-xl shadow-md border border-gray-300">
            <div class="flex items-center gap-3">
              <div class="job-icon text-4xl bg-pink-200 p-2 rounded-full">‚òÄÔ∏è</div>
              <div>
                <h3 class="font-bold text-lg">Junior Designer</h3>
                <p class="text-gray-600">Abcd Technologies Pvt Ltd.</p>
                <p class="text-gray-500 flex items-center gap-1">üìç Calicut, Kerala</p>
              </div>
            </div>
            <hr class="my-3 border-gray-400">
            <div class="text-sm text-gray-700 space-y-1">
              <p>Hourly Rate <span class="float-right">: 500/Hour</span></p>
              <p>Total Work Hours <span class="float-right">: 5 Hour</span></p>
              <p>Total Earnings <span class="float-right">: 2500 RS</span></p>
            </div>
          </div>

          <div class="job-card bg-white p-4 rounded-xl shadow-md border border-gray-300">
            <div class="flex items-center gap-3">
              <div class="job-icon text-4xl bg-pink-200 p-2 rounded-full">‚òÄÔ∏è</div>
              <div>
                <h3 class="font-bold text-lg">House Keeping</h3>
                <p class="text-gray-600">Abcd Technologies Pvt Ltd.</p>
                <p class="text-gray-500 flex items-center gap-1">üìç Calicut, Kerala</p>
              </div>
            </div>
            <hr class="my-3 border-gray-400">
            <div class="text-sm text-gray-700 space-y-1">
              <p>Hourly Rate <span class="float-right">: 500/Hour</span></p>
              <p>Total Work Hours <span class="float-right">: 5 Hour</span></p>
              <p>Total Earnings <span class="float-right">: 2500 RS</span></p>
            </div>
          </div>
          <div class="job-card bg-white p-4 rounded-xl shadow-md border border-gray-300">
            <div class="flex items-center gap-3">
              <div class="job-icon text-4xl bg-pink-200 p-2 rounded-full">‚òÄÔ∏è</div>
              <div>
                <h3 class="font-bold text-lg">Carpenter</h3>
                <p class="text-gray-600">Abcd Technologies Pvt Ltd.</p>
                <p class="text-gray-500 flex items-center gap-1">üìç Calicut, Kerala</p>
              </div>
            </div>
            <hr class="my-3 border-gray-400">
            <div class="text-sm text-gray-700 space-y-1">
              <p>Hourly Rate <span class="float-right">: 500/Hour</span></p>
              <p>Total Work Hours <span class="float-right">: 5 Hour</span></p>
              <p>Total Earnings <span class="float-right">: 2500 RS</span></p>
            </div>
          </div>
          <div class="job-card bg-white p-4 rounded-xl shadow-md border border-gray-300">
            <div class="flex items-center gap-3">
              <div class="job-icon text-4xl bg-pink-200 p-2 rounded-full">‚òÄÔ∏è</div>
              <div>
                <h3 class="font-bold text-lg">Driver</h3>
                <p class="text-gray-600">Abcd Technologies Pvt Ltd.</p>
                <p class="text-gray-500 flex items-center gap-1">üìç Calicut, Kerala</p>
              </div>
            </div>
            <hr class="my-3 border-gray-400">
            <div class="text-sm text-gray-700 space-y-1">
              <p>Hourly Rate <span class="float-right">: 500/Hour</span></p>
              <p>Total Work Hours <span class="float-right">: 5 Hour</span></p>
              <p>Total Earnings <span class="float-right">: 2500 RS</span></p>
            </div>
          </div>

          <div class="job-card bg-white p-4 rounded-xl shadow-md border border-gray-300">
            <div class="flex items-center gap-3">
              <div class="job-icon text-4xl bg-pink-200 p-2 rounded-full">‚òÄÔ∏è</div>
              <div>
                <h3 class="font-bold text-lg">Cleaner</h3>
                <p class="text-gray-600">Abcd Technologies Pvt Ltd.</p>
                <p class="text-gray-500 flex items-center gap-1">üìç Calicut, Kerala</p>
              </div>
            </div>
            <hr class="my-3 border-gray-400">
            <div class="text-sm text-gray-700 space-y-1">
              <p>Hourly Rate <span class="float-right">: 500/Hour</span></p>
              <p>Total Work Hours <span class="float-right">: 5 Hour</span></p>
              <p>Total Earnings <span class="float-right">: 2500 RS</span></p>
            </div>
          </div>
        </div>

        <div id="applied-jobs" class="job-listings grid grid-cols-2 gap-6 hidden">
          {% for application in applied_jobs %}
          {% with job=application.job %}
          <a href="{% url 'apply_for_job' job.id %}" class="block">
            <div
              class="job-card bg-blue-50 p-4 rounded-lg shadow-md hover:shadow-lg transition-transform hover:scale-105">
              <div class="job-icon text-4xl mb-2">
                {{ job.icon|default:"üíº" }}
              </div>
              <h3 class="font-semibold">{{ job.job_name }}</h3>
              <p class="text-gray-500">{{ job.company_name }}</p>
              <p class="text-gray-500">{{ job.location }}</p>
              <p class="text-gray-500">Hourly Rate: {{ job.salary }}/Hour</p>
              <p class="text-gray-500">¬© Applied {{ application.applied_date|timesince }} ago</p>

              {% if application.status == "accepted" %}
              <span class="text-green-500 bg-green-100 px-2 py-1 rounded">‚úîÔ∏è Application Accepted</span>
              {% elif application.status == "rejected" %}
              <span class="text-red-500 bg-red-100 px-2 py-1 rounded">‚ùå Application Rejected</span>
              {% elif application.status == "viewed" %}
              <span class="text-blue-500 bg-blue-100 px-2 py-1 rounded">üëÅÔ∏è Resume Viewed {{
                application.viewed_date|timesince }} ago</span>
              {% endif %}
            </div>
          </a>
          {% endwith %}
          {% empty %}
          <p class="col-span-2 text-center text-gray-500">No applied jobs found.</p>
          {% endfor %}
        </div>

        <div id="saved-jobs" class="job-listings grid grid-cols-2 gap-6 hidden">
          {% for saved in saved_jobs %}
          <a href="{% url 'apply_for_job' saved.job.id %}" class="block">
            <div
              class="job-card bg-blue-50 p-4 rounded-lg shadow-md hover:shadow-lg transition-transform hover:scale-105 relative">
              <div class="job-icon text-4xl mb-2">üîñ</div>
              <div class="absolute top-2 left-2 text-blue-500">üîñ</div> <!-- Saved Icon -->
              <h3 class="font-semibold">{{ saved.job.job_name }}</h3>
              <p class="text-gray-500">{{ saved.job.company_name }}</p>
              <p class="text-gray-500">{{ saved.job.location }}</p>
              <div class="job-footer mt-3 flex justify-between text-sm text-gray-600">
                <span>üóìÔ∏è Posted {{ saved.job.created_at|timesince }} ago</span>
                {% if saved.job.status == 'active' %}
                <span>üì¢ Actively Recruiting</span>
                {% endif %}
              </div>
            </div>
          </a>
          {% empty %}
          <p class="text-gray-500">You haven‚Äôt saved any jobs yet.</p>
          {% endfor %}
        </div>

        <!-- Recruiter
            Action -->
        <div id="recruiter-action" class="job-listings grid grid-cols-2 gap-6">
          {% for application in applied_jobs %}
          {% with job=application.job %}
          <div class="job-card bg-blue-50 p-4 rounded-lg shadow-md relative group">

            <!-- Make the whole card (except the button) clickable -->
            <a href="{% url 'jobseeker_job_detail' job.id %}" class="absolute inset-0 z-0"></a>

            <div class="relative z-10">
              <div class="job-icon text-4xl mb-2">üîß</div>
              <h3 class="font-semibold">{{ job.job_name }}</h3>
              <p class="text-gray-500">{{ job.company_name }}</p>
              <p class="text-gray-500">{{ job.location }}</p>

              <div class="job-footer mt-3 flex justify-between text-sm text-gray-600">
                {% if job.status == "Open" %}
                <span>üì¢ Actively Recruiting</span>
                {% else %}
                <span>üö´ No longer accepting applications</span>
                {% endif %}
                <span>üóìÔ∏è Posted {{ job.posted_at|timesince }} ago</span>
              </div>

              <div class="recruiter-action mt-4 z-20 relative">
                <a href="{% url 'recruiter_action' job.id %}"
                  class="nav-btn bg-blue-500 hover:bg-blue-600 transition text-white px-6 py-3 rounded-md">
                  Recruiter Action
                </a>
              </div>
            </div>

          </div>
          {% endwith %}
          {% empty %}
          <p class="text-gray-500">No applied jobs found.</p>
          {% endfor %}
        </div>

      </div>

    </div>


    <!-- Blank Sections -->
    <div id="applied-jobs" class="job-listings grid grid-cols-2 gap-6 hidden"></div>
    <div id="saved-jobs" class="job-listings grid grid-cols-2 gap-6 hidden"></div>
    <div id="recruiter-action" class="job-listings grid grid-cols-2 gap-6 hidden"></div>

    </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Handle navigation button clicks
      document.querySelectorAll('.nav-btn').forEach(button => {
        button.addEventListener('click', () => {
          const target = button.getAttribute('data-target');
          document.querySelectorAll('.job-listings').forEach(section => {
            section.classList.add('hidden');
          });
          document.getElementById(target).classList.remove('hidden');
        });
      });

      // Initially hide all job listings except the first one
      document.querySelectorAll('.job-listings').forEach((section, index) => {
        if (index !== 0) {
          section.classList.add('hidden');
        }
      });
    });

    function openFilterPopup() {
      document.getElementById('filterPopup').style.display = 'block';
      document.getElementById('filterOverlay').style.display = 'block';
    }

    function closeFilterPopup() {
      document.getElementById('filterPopup').style.display = 'none';
      document.getElementById('filterOverlay').style.display = 'none';
    }

    document.querySelectorAll('.nav-btn').forEach(button => {
      button.addEventListener('click', () => {
        const target = button.getAttribute('data-target');
        document.querySelectorAll('.recruiter-action-section').forEach(section => {
          section.classList.add('hidden');
        });
        document.getElementById(target).classList.remove('hidden');
      });
    });
function searchJobs() {
    const query = document.getElementById("jobSearchInput").value.toLowerCase();
    const allCards = document.querySelectorAll(".job-card");

    allCards.forEach(card => {
      const text = card.innerText.toLowerCase();
      if (text.includes(query)) {
        card.style.display = "block";
      } else {
        card.style.display = "none";
      }
    });
  }

  function openFilterPopup() {
    document.getElementById("filterOverlay").style.display = "block";
    document.getElementById("filterPopup").style.display = "block";
  }

  function closeFilterPopup() {
    document.getElementById("filterOverlay").style.display = "none";
    document.getElementById("filterPopup").style.display = "none";
  }
   document.addEventListener("DOMContentLoaded", function () {
    const contactDropdown = document.getElementById("contactDropdown");
    const contactMenu = document.getElementById("contactMenu");

    contactDropdown.addEventListener("click", function (event) {
      event.preventDefault(); // prevent link navigation
      contactMenu.classList.toggle("hidden");
    });

    // Optional: Close the menu when clicking outside
    document.addEventListener("click", function (event) {
      if (!contactDropdown.contains(event.target) && !contactMenu.contains(event.target)) {
        contactMenu.classList.add("hidden");
      }
    });
  });
  </script>
</body>

</html>